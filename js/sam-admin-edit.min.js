/**
 * @author minimus
 * @copyright 2010 - 2013
 */
(function(n){n(document).ready(function(){var at=n("#editor_mode").val(),ct,oi,lt,wi,yt,bi,h,di,ot,li,st,hi,ht,vi,vt,pi,pt,ei,nt,ki,k,ci,d,ai,g,yi;n("#title").tooltip({track:!0});var t=n.parseJSON(n.ajax({url:ajaxurl,data:{action:"get_strings"},async:!1,dataType:"jsonp"}).responseText),gi=n("#upload-file-button"),ti=n("#uploading"),nr=n("#uploading-help"),si=n("#load_img"),u,tr="",ir=new AjaxUpload(gi,{action:ajaxurl,name:"uploadfile",data:{action:"upload_ad_image"},onSubmit:function(n,i){if(!(i&&/^(jpg|png|jpeg|gif|swf)$/.test(i)))return ti.text(t.status),!1;si.show(),ti.text(t.uploading)},onComplete:function(i,r){ti.text(""),si.hide(),n('<div id="files"></div>').appendTo(nr),r=="success"?(n("#files").text(t.file+" "+i+" "+t.uploaded).addClass("updated").delay(3e3).fadeOut(1e3,function(){n(this).remove()}),at=="item"?n("#ad_img").val(t.url+i):at=="place"&&n("#patch_img").val(t.url+i)):n("#files").text(i+" "+r).addClass("error").delay(3e3).fadeOut(1e3,function(){n(this).remove()})}});if(at=="item"){u=samPointer.ads,u.pointer="ads",n("#ad_start_date, #ad_end_date").datepicker({dateFormat:"yy-mm-dd",showButtonPanel:!0}),n("#adv_nick").combogrid({url:ajaxurl+"?action=get_combo_data",datatype:"json",munit:"px",alternate:!0,colModel:t.users.colModel,select:function(t,i){return n("#adv_nick").val(i.item.slug),n("#adv_name").val(i.item.title),n("#adv_mail").val(i.item.email),!1}});function i(t,i,r,u,f,e,o){var s=u.val(),h;i.w2grid({name:t,show:{selectColumn:!0},multiSelect:!0,columns:e,records:o,onSelect:function(n){n.onComplete=function(){for(var e="",r=this.getSelection(),i,t,n=0;n<r.length;n++)t=this.get(r[n]),i=f=="id"?t.id:t.slug,e+=n==r.length-1?i:i+",";u.val(e)}},onUnselect:function(n){n.onComplete=function(){for(var e="",r=this.getSelection(),i,t,n=0;n<r.length;n++)t=this.get(r[n]),i=f=="id"?t.id:t.slug,e+=n==r.length-1?i:i+",";u.val(e)}}}),null!=s&&""!=s&&(h=s.split(","),n.each(h,function(i,r){n.each(o,function(n,i){var u=f=="id"?i.id:i.slug;return u==r?(w2ui[t].select(i.recid),!1):!0})}))}ct=n("#ctt-grid"),oi=n("#view-custom-tax-terms"),i("ctt-grid",ct,"view-custom-tax-terms",oi,"slug",t.custom_taxes.columns,t.custom_taxes.taxes),lt=n("#x-ctt-grid"),wi=n("#x-view-custom-tax-terms"),i("x-ctt-grid",lt,"x-view-custom-tax-terms",wi,"slug",t.custom_taxes.columns,t.custom_taxes.taxes),yt=n("#posts-grid"),bi=n("#view_id"),i("posts-grid",yt,"view_id",bi,"id",t.posts.columns,t.posts.posts),h=n("#users-grid"),di=n("#x_view_users"),i("users-grid",h,"x_view_users",di,"slug",t.users.columns,t.users.users),ot=n("#x-posts-grid"),li=n("#x_view_id"),i("x-posts-grid",ot,"x_view_id",li,"id",t.posts.columns,t.posts.posts),st=n("#cats-grid"),hi=n("#view_cats"),i("cats-grid",st,"view_cats",hi,"slug",t.cats.columns,t.cats.cats),ht=n("#x-cats-grid"),vi=n("#x_view_cats"),i("x-cats-grid",ht,"x_view_cats",vi,"slug",t.cats.columns,t.cats.cats),vt=n("#auth-grid"),pi=n("#view_authors"),i("auth-grid",vt,"view_authors",pi,"slug",t.authors.columns,t.authors.authors),pt=n("#x-auth-grid"),ei=n("#x_view_authors"),i("x-auth-grid",pt,"x_view_authors",ei,"slug",t.authors.columns,t.authors.authors),nt=n("#tags-grid"),ki=n("#view_tags"),i("tags-grid",nt,"view_tags",ki,"slug",t.tags.columns,t.tags.tags),k=n("#x-tags-grid"),ci=n("#x_view_tags"),i("x-tags-grid",k,"x_view_tags",ci,"slug",t.tags.columns,t.tags.tags),d=n("#cust-grid"),ai=n("#view_custom"),i("cust-grid",d,"view_custom",ai,"slug",t.customs.columns,t.customs.customs),g=n("#x-cust-grid"),yi=n("#x_view_custom"),i("x-cust-grid",g,"x_view_custom",yi,"slug",t.customs.columns,t.customs.customs),n("#tabs").tabs({activate:function(t,i){var r=i.newPanel[0].id;r=="tabs-1"&&yt.w2render("posts-grid"),r=="tabs-2"&&(n("#rc-ctt").is(":visible")&&ct.w2render("ctt-grid"),n("#rc-xct").is(":visible")&&lt.w2render("x-ctt-grid"),n("#rc-xid").is(":visible")&&ot.w2render("x-posts-grid"),n("#x-view-users").is(":visible")&&h.w2render("users-grid"),n("#rc-ac").is(":visible")&&st.w2render("cats-grid"),n("#rc-xc").is(":visible")&&ht.w2render("x-cats-grid"),n("#rc-au").is(":visible")&&vt.w2render("auth-grid"),n("#rc-xa").is(":visible")&&pt.w2render("x-auth-grid"),n("#rc-at").is(":visible")&&nt.w2render("tags-grid"),n("#rc-xt").is(":visible")&&k.w2render("x-tags-grid"),n("#rc-cu").is(":visible")&&d.w2render("cust-grid"),n("#rc-xu").is(":visible")&&g.w2render("x-cust-grid"))}}),n("#add-file-button").click(function(){var i=t.url+n("select#files_list option:selected").val();return n("#ad_img").val(i),!1}),n("#code_mode_false").click(function(){n("#rc-cmf").show("blind",{direction:"vertical"},500),n("#rc-cmt").hide("blind",{direction:"vertical"},500)}),n("#code_mode_true").click(function(){n("#rc-cmf").hide("blind",{direction:"vertical"},500),n("#rc-cmt").show("blind",{direction:"vertical"},500)});var f=n("#rc-vt0"),c=n("#rc-vt2"),r=n("#x_id"),ut=n("#rc-xid");2==n("input:radio[name=view_type]:checked").val()&&(r.is(":checked")&&(r.attr("checked",!1),ut.hide("blind",{direction:"vertical"},500)),r.attr("disabled",!0)),n("input:radio[name=view_type]").click(function(){var t=n("input:radio[name=view_type]:checked").val();switch(t){case"0":f.is(":hidden")&&f.show("blind",{direction:"vertical"},500),c.is(":visible")&&c.hide("blind",{direction:"vertical"},500),r.attr("disabled",!1);break;case"1":f.is(":visible")&&f.hide("blind",{direction:"vertical"},500),c.is(":visible")&&c.hide("blind",{direction:"vertical"},500),r.attr("disabled",!1);break;case"2":f.is(":visible")&&f.hide("blind",{direction:"vertical"},500),c.is(":hidden")&&(c.show("blind",{direction:"vertical"},500,function(){yt.w2render("posts-grid")}),r.is(":checked")&&(r.attr("checked",!1),ut.hide("blind",{direction:"vertical"},500))),r.attr("disabled",!0)}}),r.click(function(){r.is(":checked")?2==n("input:radio[name=view_type]:checked").val()?r.attr("checked",!1):ut.show("blind",{direction:"vertical"},500,function(){ot.w2render("x-posts-grid")}):ut.hide("blind",{direction:"vertical"},500)}),n("input:radio[name=ad_users]").click(function(){var t=n("input:radio[name=ad_users]:checked").val();t=="0"?n("#custom-users").is(":visible")&&n("#custom-users").hide("blind",{direction:"vertical"},500):n("#custom-users").is(":hidden")&&n("#custom-users").show("blind",{direction:"vertical"},500,function(){n("#x-view-users").is(":visible")&&h.w2render("users-grid")})}),n("#ad_users_reg").click(function(){n("#ad_users_reg").is(":checked")?n("#x-reg-users").show("blind",{direction:"vertical"},500,function(){n("#x-view-users").is(":visible")&&h.w2render("users-grid")}):n("#x-reg-users").hide("blind",{direction:"vertical"},500)}),n("#x_ad_users").click(function(){n("#x_ad_users").is(":checked")?n("#x-view-users").show("blind",{direction:"vertical"},500,function(){h.w2render("users-grid")}):n("#x-view-users").hide("blind",{direction:"vertical"},500)}),n("#ad_swf").click(function(){n("#ad_swf").is(":checked")?n("#swf-params").show("blind",{direction:"vertical"},500):n("#swf-params").hide("blind",{direction:"vertical"},500)});var p=n("#ad_cats"),ni=n("#rc-ac"),bt=n("#acw"),o=n("#x_cats"),ft=n("#rc-xc");p.is(":checked")&&o.is(":checked")&&(o.attr("checked",!1),ft.hide("blind",{direction:"vertical"},500)),p.click(function(){p.is(":checked")?(ni.show("blind",{direction:"vertical"},500,function(){st.w2render("cats-grid")}),bt.show("blind",{direction:"vertical"},500),o.is(":checked")&&(o.attr("checked",!1),ft.hide("blind",{direction:"vertical"},500))):(ni.hide("blind",{direction:"vertical"},500),bt.hide("blind",{direction:"vertical"},500))}),o.click(function(){o.is(":checked")?(ft.show("blind",{direction:"vertical"},500,function(){ht.w2render("x-cats-grid")}),p.is(":checked")&&(p.attr("checked",!1),ni.hide("blind",{direction:"vertical"},500),bt.hide("blind",{direction:"vertical"},500))):ft.hide("blind",{direction:"vertical"},500)});var b=n("#ad_custom_tax_terms"),kt=n("#rc-ctt"),dt=n("#cttw"),s=n("#x_ad_custom_tax_terms"),tt=n("#rc-xct");b.is(":checked")&&s.is(":checked")&&(s.attr("checked",!1),tt.hide("blind",{direction:"vertical"},500)),b.click(function(){b.is(":checked")?(kt.show("blind",{direction:"vertical"},500,function(){ct.w2render("ctt-grid")}),dt.show("blind",{direction:"vertical"},500),s.is(":checked")&&(s.attr("checked",!1),tt.hide("blind",{direction:"vertical"},500))):(kt.hide("blind",{direction:"vertical"},500),dt.hide("blind",{direction:"vertical"},500))}),s.click(function(){s.is(":checked")?(tt.show("blind",{direction:"vertical"},500,function(){lt.w2render("x-ctt-grid")}),b.is(":checked")&&(b.attr("checked",!1),kt.hide("blind",{direction:"vertical"},500),dt.hide("blind",{direction:"vertical"},500))):tt.hide("blind",{direction:"vertical"},500)});var w=n("#ad_authors"),gt=n("#rc-au"),wt=n("#aaw"),e=n("#x_authors"),it=n("#rc-xa");w.is(":checked")&&e.is(":checked")&&(e.attr("checked",!1),it.hide("blind",{direction:"vertical"},500)),w.click(function(){w.is(":checked")?(gt.show("blind",{direction:"vertical"},500,function(){vt.w2render("auth-grid")}),wt.show("blind",{direction:"vertical"},500),e.is(":checked")&&(e.attr("checked",!1),it.hide("blind",{direction:"vertical"},500))):(gt.hide("blind",{direction:"vertical"},500),wt.hide("blind",{direction:"vertical"},500))}),e.click(function(){e.is(":checked")?(it.show("blind",{direction:"vertical"},500,function(){pt.w2render("x-auth-grid")}),w.is(":checked")&&(w.attr("checked",!1),gt.hide("blind",{direction:"vertical"},500),wt.hide("blind",{direction:"vertical"},500))):it.hide("blind",{direction:"vertical"},500)});var v=n("#ad_tags"),fi=n("#rc-at"),ui=n("#atw"),l=n("#x_tags"),rt=n("#rc-xt");v.is(":checked")&&l.is(":checked")&&(l.attr("checked",!1),rt.hide("blind",{direction:"vertical"},500)),v.click(function(){v.is(":checked")?(fi.show("blind",{direction:"vertical"},500,function(){nt.w2render("tags-grid")}),ui.show("blind",{direction:"vertical"},500),l.is(":checked")&&(l.attr("checked",!1),rt.hide("blind",{direction:"vertical"},500))):(fi.hide("blind",{direction:"vertical"},500),ui.hide("blind",{direction:"vertical"},500))}),l.click(function(){l.is(":checked")?(rt.show("blind",{direction:"vertical"},500,function(){k.w2render("x-tags-grid")}),v.is(":checked")&&(v.attr("checked",!1),fi.hide("blind",{direction:"vertical"},500),ui.hide("blind",{direction:"vertical"},500))):rt.hide("blind",{direction:"vertical"},500)});var y=n("#ad_custom"),ii=n("#rc-cu"),ri=n("#cuw"),a=n("#x_custom"),et=n("#rc-xu");y.is(":checked")&&a.is(":checked")&&(a.attr("checked",!1),et.hide("blind",{direction:"vertical"},500)),y.click(function(){y.is(":checked")?(ii.show("blind",{direction:"vertical"},500,function(){d.w2render("cust-grid")}),ri.show("blind",{direction:"vertical"},500),a.is(":checked")&&(a.attr("checked",!1),et.hide("blind",{direction:"vertical"},500))):(ii.hide("blind",{direction:"vertical"},500),ri.hide("blind",{direction:"vertical"},500))}),a.click(function(){a.is(":checked")?(et.show("blind",{direction:"vertical"},500,function(){g.w2render("x-cust-grid")}),y.is(":checked")&&(y.attr("checked",!1),ii.hide("blind",{direction:"vertical"},500),ri.hide("blind",{direction:"vertical"},500))):et.hide("blind",{direction:"vertical"},500)}),n("#ad_schedule").click(function(){n("#ad_schedule").is(":checked")?n("#rc-sc").show("blind",{direction:"vertical"},500):n("#rc-sc").hide("blind",{direction:"vertical"},500)}),n("#limit_hits").click(function(){n("#limit_hits").is(":checked")?n("#rc-hl").show("blind",{direction:"vertical"},500):n("#rc-hl").hide("blind",{direction:"vertical"},500)}),n("#limit_clicks").click(function(){n("#limit_clicks").is(":checked")?n("#rc-cl").show("blind",{direction:"vertical"},500):n("#rc-cl").hide("blind",{direction:"vertical"},500)})}return at=="place"&&(u=samPointer.places,u.pointer="places",n("#add-file-button").click(function(){var i=t.url+n("select#files_list option:selected").val();return n("#patch_img").val(i),!1}),n("#patch_source_image").click(function(){n("#rc-psi").is(":hidden")&&n("#rc-psi").show("blind",{direction:"vertical"},500),n("#rc-psc").is(":visible")&&n("#rc-psc").hide("blind",{direction:"vertical"},500),n("#rc-psd").is(":visible")&&n("#rc-psd").hide("blind",{direction:"vertical"},500)}),n("#patch_source_code").click(function(){n("#rc-psi").is(":visible")&&n("#rc-psi").hide("blind",{direction:"vertical"},500),n("#rc-psc").is(":hidden")&&n("#rc-psc").show("blind",{direction:"vertical"},500),n("#rc-psd").is(":visible")&&n("#rc-psd").hide("blind",{direction:"vertical"},500)}),n("#patch_source_dfp").click(function(){n("#rc-psi").is(":visible")&&n("#rc-psi").hide("blind",{direction:"vertical"},500),n("#rc-psc").is(":visible")&&n("#rc-psc").hide("blind",{direction:"vertical"},500),n("#rc-psd").is(":hidden")&&n("#rc-psd").show("blind",{direction:"vertical"},500)})),(u.enabled||""==n("#title").val())&&n("#title").pointer({content:"<h3>"+u.title+"</h3><p>"+u.content+"</p>",position:"top",close:function(){n.ajax({url:ajaxurl,data:{action:"close_pointer",pointer:u.pointer},async:!0})}}).pointer("open"),n("#is_singular").click(function(){n("#is_singular").is(":checked")&&n("#is_single, #is_page, #is_attachment, #is_posttype").attr("checked",!0)}),n("#is_single, #is_page, #is_attachment, #is_posttype").click(function(){!n("#is_singular").is(":checked")||n("#is_single").is(":checked")&&n("#is_page").is(":checked")&&n("#is_attachment").is(":checked")&&n("#is_posttype").is(":checked")?!n("#is_singular").is(":checked")&&n("#is_single").is(":checked")&&n("#is_posttype").is(":checked")&&n("#is_page").is(":checked")&&n("#is_attachment").is(":checked")&&n("#is_singular").attr("checked",!0):n("#is_singular").attr("checked",!1)}),n("#is_archive").click(function(){n("#is_archive").is(":checked")&&n("#is_tax, #is_category, #is_tag, #is_author, #is_date, #is_posttype_archive").attr("checked",!0)}),n("#is_tax, #is_category, #is_tag, #is_author, #is_date, #is_posttype_archive").click(function(){!n("#is_archive").is(":checked")||n("#is_tax").is(":checked")&&n("#is_category").is(":checked")&&n("#is_posttype_archive").is(":checked")&&n("#is_tag").is(":checked")&&n("#is_author").is(":checked")&&n("#is_date").is(":checked")?!n("#is_archive").is(":checked")&&n("#is_tax").is(":checked")&&n("#is_category").is(":checked")&&n("#is_posttype_archive").is(":checked")&&n("#is_tag").is(":checked")&&n("#is_author").is(":checked")&&n("#is_date").is(":checked")&&n("#is_archive").attr("checked",!0):n("#is_archive").attr("checked",!1)}),!1})})(jQuery);