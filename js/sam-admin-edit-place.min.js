var sam=sam||{};(function(n){var t,i=samEditorOptions.media;sam.media=t={buttonId:"#banner-media",adUrl:"#patch_img",adImgId:"#patch_img_id",adName:"#title",adDesc:"#description",init:function(){n(this.buttonId).on("click",this.openMediaDialog)},openMediaDialog:function(n){if(n.preventDefault(),this._frame){this._frame.open();return}var r=wp.media.model.Attachment;this._frame=t.frame=wp.media({title:i.title,button:{text:i.button},multiple:!1,library:{type:"image"}});this._frame.on("ready",function(){});this._frame.state("library").on("select",function(){var n=this.get("selection").single();t.handleMediaAttachment(n)});this._frame.open()},handleMediaAttachment:function(t){var i=t.toJSON();n(this.adUrl).val(i.url);n(this.adImgId).val(i.id);""==n(this.adName).val()&&""!=i.title&&n(this.adName).val(i.title);""==n(this.adDesc).val()&&""!=i.caption&&n(this.adDesc).val(i.caption);""==n(this.adAlt).val()&&""!=i.alt&&n(this.adAlt).val(i.alt)}};n(document).ready(function(){var s=n("#editor_mode").val(),l,r=n("#rc-psi"),u=n("#rc-psc"),f=n("#rc-psd"),h=n("#title"),a=n("#upload-file-button"),o=n("#uploading"),v=n("#uploading-help"),c=n("#load_img"),e,i;return e=samEditorOptions.places,e.pointer="places",t.init(),h.tooltip({track:!0}),i=samEditorOptions.options,l=new AjaxUpload(a,{action:ajaxurl,name:"uploadfile",data:{action:"upload_ad_image"},onSubmit:function(n,t){if(!(t&&/^(jpg|png|jpeg|gif|swf)$/.test(t)))return o.text(i.status),!1;c.show();o.text(i.uploading)},onComplete:function(t,r){o.text("");c.hide();n('<div id="files"><\/div>').appendTo(v);r=="success"?(n("#files").text(i.file+" "+t+" "+i.uploaded).addClass("updated").delay(3e3).fadeOut(1e3,function(){n(this).remove()}),s=="item"?n("#ad_img").val(i.url+t):s=="place"&&n("#patch_img").val(i.url+t)):n("#files").text(t+" "+r).addClass("error").delay(3e3).fadeOut(1e3,function(){n(this).remove()})}}),n("#image_tools").tabs(),n("#add-file-button").click(function(){var t=i.url+n("select#files_list option:selected").val();return n("#patch_img").val(t),!1}),n("#patch_source_image").click(function(){r.is(":hidden")&&r.show("blind",{direction:"vertical"},500);u.is(":visible")&&u.hide("blind",{direction:"vertical"},500);f.is(":visible")&&f.hide("blind",{direction:"vertical"},500)}),n("#patch_source_code").click(function(){r.is(":visible")&&r.hide("blind",{direction:"vertical"},500);u.is(":hidden")&&u.show("blind",{direction:"vertical"},500);f.is(":visible")&&f.hide("blind",{direction:"vertical"},500)}),n("#patch_source_dfp").click(function(){r.is(":visible")&&r.hide("blind",{direction:"vertical"},500);u.is(":visible")&&u.hide("blind",{direction:"vertical"},500);f.is(":hidden")&&f.show("blind",{direction:"vertical"},500)}),(e.enabled||""==h.val())&&n("#title").pointer({content:"<h3>"+e.title+"<\/h3><p>"+e.content+"<\/p>",position:"top",close:function(){n.ajax({url:ajaxurl,data:{action:"close_pointer",pointer:e.pointer},async:!0})}}).pointer("open"),!1})})(jQuery)